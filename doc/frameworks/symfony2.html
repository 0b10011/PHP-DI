<!DOCTYPE html>
<!--[if lt IE 7]>
<html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>
<html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>
<html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js"> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width">

    <title>PHP-DI - The Dependency Injection Container for humans</title>
    <meta name="description" content="PHP-DI is a Dependency Injection Container for PHP that intends to be practical and powerful">

    <link rel="canonical" href="http://php-di.org" />

            <link href="http://php-di.org/css/bootstrap-theme_venera.min.css" media="all" rel="stylesheet" type="text/css">
        <link href="http://fonts.googleapis.com/css?family=Abel:400|Oswald:300,400,700" media="all" rel="stylesheet" type="text/css">
        <link href="http://php-di.org/css/highlight.github.css" rel="stylesheet">
        <link href="http://php-di.org/css/custom.css" rel="stylesheet">
    
    <script>
        if (window.location.href.indexOf('http://mnapoli.fr') === 0) {
            window.location.href = 'http://php-di.org';
        }
    </script>
</head>
<body>

    <header id='header'>
        <div class='navbar navbar-fixed-top'>
            <div class='navbar-inner'>
                <div class='container'>
                    <a class='btn btn-navbar' data-target='.nav-collapse' data-toggle='collapse'>
                        <span class='icon-bar'></span>
                        <span class='icon-bar'></span>
                        <span class='icon-bar'></span>
                    </a>
                    <a href="http://php-di.org/index.html" class="brand">PHP-DI</a>

                    <div class='nav-collapse subnav-collapse collapse pull-right' id='top-navigation'>
                        <ul class='nav'>
                            <li><a href="http://php-di.org/">Home</a></li>
                            <li><a href="http://php-di.org/news/">News</a></li>
                            <li><a href="http://php-di.org/doc/getting-started.html">Getting started</a></li>
                            <li><a href="http://php-di.org/doc/">Documentation</a></li>
                            <li><a href="http://php-di.org/change-log.html">Change log</a></li>
                            <li><a href="https://github.com/mnapoli/PHP-DI"><i class="icon-github"></i> Github</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </header>

    
    <header class="jumbotron subhead" id="overview">
        <div class="container">
            <div class="docs-header-icon">
                <h1>Documentation</h1>
                <p class="lead">
                    This is the documentation for PHP-DI 4. The documentation for v3 is
                    <a href="https://github.com/mnapoli/PHP-DI/tree/3.x/doc">still available here</a>.
                </p>
            </div>
        </div>
    </header>
    <div class='sub-jumbotron'>
        <div class='container'>
            <ul>
                <li>
                    <a href="/doc/" class="">Full documentation</a>
                </li>
                <li>
                    <a href="/doc/getting-started.html" class="">Getting started</a>
                </li>
                <li>
                    <a href="/doc/best-practices.html" class="">Best practices</a>
                </li>
                <li>
                    <a href="/doc/container-configuration.html" class="">Configuring the container</a>
                </li>
                <li>
                    <a href="/doc/container.html" class="">Using the container</a>
                </li>
                <li>
                    <a href="/doc/definition.html" class="">Defining injections</a>
                </li>
            </ul>
        </div>
    </div>

    <div class="container docs-w">
        <h1>PHP-DI in Symfony 2</h1>
<p>If you are using Symfony 2, PHP-DI provides easy and clean integration, without replacing the original container
(so all bundles and existing code still work).</p>
<p>Just to be clear: PHP-DI will work alongside Symfony's container. So you can use both at the same time.</p>
<h2>Installation</h2>
<p>First, install the bridge:</p>
<pre><code class="language-json">{
    "require": {
        "mnapoli/php-di": "The version you want here",
        "mnapoli/php-di-symfony2": "*"
    }
}</code></pre>
<p>Now you need to configure Symfony to use the alternative container in your <code>AppKernel</code>:</p>
<pre><code class="language-php">class AppKernel extends Kernel
{
    /**
     * Gets the container's base class.
     *
     * @return string
     */
    protected function getContainerBaseClass()
    {
        return 'DI\Bridge\Symfony\SymfonyContainerBridge';
    }

    /**
     * Initializes the DI container.
     */
    protected function initializeContainer()
    {
        parent::initializeContainer();

        // Configure your container here
        // http://php-di.org/doc/container-configuration
        $builder = new \DI\ContainerBuilder();
        $builder-&gt;wrapContainer($this-&gt;getContainer());

        $this-&gt;getContainer()-&gt;setFallbackContainer($builder-&gt;build());
    }
}</code></pre>
<h2>Usage</h2>
<p>You can now define <a href="http://symfony.com/doc/current/cookbook/controller/service.html">controllers as services</a>,
without any configuration, using PHP-DI's power!</p>
<p>Example for the routing configuration:</p>
<pre><code class="language-yaml">my_route:
    pattern:  /product-stock/clear
    defaults: { _controller: MyBundle\Controller\ProductController:clearAction }</code></pre>
<p><strong>Careful! Note that you need to use <code>:</code> as a separator, not <code>::</code> (else it will not go through the container).</strong>
The <code>:</code> notation means <code>service_id:method</code>, whereas the <code>::</code> notation means <code>class::method</code>.</p>
<p>Example with constructor injection:</p>
<pre><code class="language-php">class ProductController
{
    private $productService;

    public function __construct(ProductService $productService)
    {
        $this-&gt;productService = $productService;
    }

    public function clearAction()
    {
        $this-&gt;productService-&gt;clearStock();
    }
}</code></pre>
<p>Example with property injection:</p>
<pre><code class="language-php">class ProductController
{
    /**
     * @Inject
     * @var ProductService
     */
    private $productService;

    public function clearAction()
    {
        $this-&gt;productService-&gt;clearStock();
    }
}</code></pre>
<h2>Using Symfony's services in PHP-DI</h2>
<p>Let's say you want to inject the <code>EntityManager</code> in your controller: the entity manager is defined
in Symfony's container, and the controller is resolved by PHP-DI.</p>
<p><strong>You can reference services that are in Symfony's container in PHP-DI's configuration</strong>.
That's because PHP-DI is designed to play nice with others:</p>
<pre><code class="language-php">return [
    'Acme\MyBundle\Controller\ProductController' =&gt; DI\object()
        -&gt;constructor(DI\link('doctrine.orm.entity_manager')),
];</code></pre>
<p>However Symfony was not designed to play with his friends, so it has no idea that there is
another container in the application. <strong>You can't inject PHP-DI's services in a Symfony service</strong>.
That's however rarely a problem.</p>
<h3>Service name aliases</h3>
<p>PHP-DI can also work with autowiring or annotations. These rely on the fact that the service name
is the class name (or interface name), e.g. you reference the entity manager by its class name
instead of <code>doctrine.orm.entity_manager</code>.</p>
<p>If you want to enjoy autowiring or annotations, you can simplify your life and write simple aliases
like these:</p>
<pre><code class="language-php">return [
    'Psr\Log\LoggerInterface' =&gt; DI\link('logger'),
    // PHP 5.5 notation:
    ObjectManager::class =&gt; DI\link('doctrine.orm.entity_manager'),
];</code></pre>
<p>Keep in mind that it's always better to type-hint against interfaces instead of class names!
So write your aliases with interfaces as much as possible.</p>
<h2>FOSRestBundle</h2>
<p>There was a bug in FOSRestBundle that would prevent using "Controller as services" in some cases.</p>
<p>This bug has been fixed and will be released in >=1.3.2 (not released yet at the time of writing).</p>
<p>Full details are here: <a href="https://github.com/FriendsOfSymfony/FOSRestBundle/pull/743">FOSRestBundle#743</a></p>
<h2>More</h2>
<p>Read more on the <a href="https://github.com/mnapoli/PHP-DI-Symfony2">PHP-DI-Symfony2 project on Github</a>.</p>
    </div>


            <footer>
            <div class='pre-footer'>
                <div class='container'>
                    <p>
                        <strong>Unsatisfied with the documentation?</strong>
                        Please let us know, <a href="https://github.com/mnapoli/PHP-DI/issues/new">create an issue</a>,
                        we will greatly appreciate it.
                        You can chat with us on
                        <a href="https://twitter.com/phpdi">Twitter</a> or
                        <a href="https://gitter.im/mnapoli/PHP-DI">Gitter chat</a> too.
                    </p>
                </div>
            </div>
            <div class='deep-footer'>
                <div class='container'>
                    <div class='copyright'>
                        Copyright &copy; 2014 <a href="http://mnapoli.fr/">Matthieu Napoli</a>
                        Website generated with
                        <a href="http://mnapoli.fr/Couscous/" target="_blank">Couscous</a>.
                    </div>
                </div>
            </div>
        </footer>
    
            <script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
        <script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js" type="text/javascript"></script>
        <script src="http://yandex.st/highlightjs/7.5/highlight.min.js"></script>
        <script src="http://php-di.org/js/template.js"></script>

        <script>
            $(function() {
                $("section>h1").wrap('<div class="page-header" />');
                $("section>p:first-child").addClass('lead');
                hljs.initHighlightingOnLoad();
            });
        </script>
    
    <script>
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-15584647-13']);
        _gaq.push(['_trackPageview']);
        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>

    <!-- Piwik -->
    <script type="text/javascript">
        var _paq = _paq || [];
        _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
        _paq.push(["setCookieDomain", "*.php-di.org"]);
        _paq.push(['trackPageView']);
        _paq.push(['enableLinkTracking']);
        (function() {
            var u=(("https:" == document.location.protocol) ? "https" : "http") + "://piwik.mnapoli.fr/";
            _paq.push(['setTrackerUrl', u+'piwik.php']);
            _paq.push(['setSiteId', 2]);
            var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0]; g.type='text/javascript';
            g.defer=true; g.async=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
        })();
    </script>
    <noscript><p><img src="http://piwik.mnapoli.fr/piwik.php?idsite=2" style="border:0;" alt="" /></p></noscript>
    <!-- End Piwik Code -->
</body>
</html>
